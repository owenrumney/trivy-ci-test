# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

# set the trigger to none so that it only runs manually
trigger: none

variables:
  SYSTEM_DEBUG: true

jobs:
- job: scan_nginx
  steps:
  - task: trivy-dev@2
    inputs:
      method: 'docker'
      version: 'latest'
      type: 'image'
      target: 'nginx'
      scanners: 'misconfig, vuln'
      ignoreUnfixed: true
      ignoreScanErrors: true
      reports: 'github, html, junit'
      publish: true



- job: use_binary
  steps:
  - task: trivy-dev@2
    inputs:
        method: 'docker'
        version: 'latest'
        type: 'image'
        target: 'nginx'
        scanners: 'secret,vuln'
        ignoreUnfixed: true
        ignoreScanErrors: true
        reports: 'github, junit, sarif'

